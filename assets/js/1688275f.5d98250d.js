"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics=globalThis.webpackChunkphysical_ai_humanoid_robotics||[]).push([[9842],{1831:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"module1/packages-python-development","title":"ROS 2 Packages and Python Development","description":"Package Structure","source":"@site/docs/module1/packages-python-development.md","sourceDirName":"module1","slug":"/module1/packages-python-development","permalink":"/Physical-AI-Humanoid-book/docs/module1/packages-python-development","draft":false,"unlisted":false,"editUrl":"https://github.com/user/physical-ai-humanoid-robotics/tree/main/docs/module1/packages-python-development.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Nodes, Topics, Services, and Actions","permalink":"/Physical-AI-Humanoid-book/docs/module1/nodes-topics-services-actions"},"next":{"title":"Gazebo Environment Setup","permalink":"/Physical-AI-Humanoid-book/docs/module2/gazebo-setup"}}');var a=s(4848),r=s(8453);const l={},i="ROS 2 Packages and Python Development",o={},c=[{value:"Package Structure",id:"package-structure",level:2},{value:"Creating a Python Package",id:"creating-a-python-package",level:2},{value:"Using colcon",id:"using-colcon",level:3},{value:"package.xml",id:"packagexml",level:3},{value:"setup.py",id:"setuppy",level:3},{value:"Python Node Development",id:"python-node-development",level:2},{value:"Basic Node Structure",id:"basic-node-structure",level:3},{value:"Parameter Management",id:"parameter-management",level:2},{value:"Testing in Python",id:"testing-in-python",level:2},{value:"Unit Tests",id:"unit-tests",level:3},{value:"Running Tests",id:"running-tests",level:3},{value:"Best Practices for Python Development",id:"best-practices-for-python-development",level:2},{value:"Example with Type Hints and Error Handling",id:"example-with-type-hints-and-error-handling",level:3},{value:"Building and Running",id:"building-and-running",level:2},{value:"Build the Package",id:"build-the-package",level:3},{value:"Source the Workspace",id:"source-the-workspace",level:3},{value:"Run the Node",id:"run-the-node",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"ros-2-packages-and-python-development",children:"ROS 2 Packages and Python Development"})}),"\n",(0,a.jsx)(n.h2,{id:"package-structure",children:"Package Structure"}),"\n",(0,a.jsx)(n.p,{children:"A ROS 2 package is a reusable, self-contained unit of software. The basic structure of a ROS 2 package is:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"my_robot_package/\n\u251c\u2500\u2500 CMakeLists.txt          # Build configuration for C++\n\u251c\u2500\u2500 package.xml             # Package metadata\n\u251c\u2500\u2500 setup.py                # Python package setup\n\u251c\u2500\u2500 setup.cfg               # Installation configuration\n\u251c\u2500\u2500 my_robot_package/       # Python module\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 publisher_member_function.py\n\u2502   \u2514\u2500\u2500 subscriber_member_function.py\n\u2514\u2500\u2500 test/                   # Test files\n    \u2514\u2500\u2500 test_copyright.py\n    \u2514\u2500\u2500 test_flake8.py\n    \u2514\u2500\u2500 test_pep257.py\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-python-package",children:"Creating a Python Package"}),"\n",(0,a.jsx)(n.h3,{id:"using-colcon",children:"Using colcon"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Create workspace\nmkdir -p ~/ros2_ws/src\ncd ~/ros2_ws/src\n\n# Create package\nros2 pkg create --build-type ament_python my_robot_package\n"})}),"\n",(0,a.jsx)(n.h3,{id:"packagexml",children:"package.xml"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"package.xml"})," file contains metadata about the package:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n  <name>my_robot_package</name>\n  <version>0.0.0</version>\n  <description>Example ROS 2 package in Python</description>\n  <maintainer email="user@example.com">User Name</maintainer>\n  <license>Apache License 2.0</license>\n\n  <depend>rclpy</depend>\n  <depend>std_msgs</depend>\n\n  <test_depend>ament_copyright</test_depend>\n  <test_depend>ament_flake8</test_depend>\n  <test_depend>ament_pep257</test_depend>\n  <test_depend>python3-pytest</test_depend>\n\n  <export>\n    <build_type>ament_python</build_type>\n  </export>\n</package>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"setuppy",children:"setup.py"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"setup.py"})," file defines how the Python package should be built and installed:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\n\npackage_name = 'my_robot_package'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=[package_name],\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='your.email@example.com',\n    description='Example ROS 2 package in Python',\n    license='Apache License 2.0',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            'talker = my_robot_package.publisher_member_function:main',\n            'listener = my_robot_package.subscriber_member_function:main',\n        ],\n    },\n)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"python-node-development",children:"Python Node Development"}),"\n",(0,a.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\n\"\"\"\nExample ROS 2 Python node\n\"\"\"\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_publisher = MinimalPublisher()\n\n    rclpy.spin(minimal_publisher)\n\n    # Destroy the node explicitly\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"parameter-management",children:"Parameter Management"}),"\n",(0,a.jsx)(n.p,{children:"ROS 2 provides a parameter system for configuration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom rcl_interfaces.msg import ParameterType\n\n\nclass ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('frequency', 1.0)\n        self.declare_parameter('robot_name', 'default_robot')\n        self.declare_parameter('max_velocity', 1.0)\n\n        # Get parameter values\n        self.frequency = self.get_parameter('frequency').value\n        self.robot_name = self.get_parameter('robot_name').value\n        self.max_velocity = self.get_parameter('max_velocity').value\n\n        self.get_logger().info(\n            f'Parameters - Frequency: {self.frequency}, '\n            f'Robot: {self.robot_name}, Max Vel: {self.max_velocity}'\n        )\n"})}),"\n",(0,a.jsx)(n.h2,{id:"testing-in-python",children:"Testing in Python"}),"\n",(0,a.jsx)(n.h3,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import unittest\nimport rclpy\nfrom rclpy.executors import SingleThreadedExecutor\nfrom my_robot_package.my_node import MyNode\n\n\nclass TestMyNode(unittest.TestCase):\n    @classmethod\n    def setUpClass(cls):\n        rclpy.init()\n\n    @classmethod\n    def tearDownClass(cls):\n        rclpy.shutdown()\n\n    def setUp(self):\n        self.node = MyNode()\n        self.executor = SingleThreadedExecutor()\n        self.executor.add_node(self.node)\n\n    def tearDown(self):\n        self.node.destroy_node()\n\n    def test_node_creation(self):\n        self.assertIsNotNone(self.node)\n        self.assertEqual(self.node.get_name(), 'my_node')\n\n    def test_parameter_declaration(self):\n        self.assertTrue(self.node.has_parameter('frequency'))\n"})}),"\n",(0,a.jsx)(n.h3,{id:"running-tests",children:"Running Tests"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Run all tests\ncolcon test\n\n# Run specific tests\ncolcon test --packages-select my_robot_package\n\n# View test results\ncolcon test-result --all\n"})}),"\n",(0,a.jsx)(n.h2,{id:"best-practices-for-python-development",children:"Best Practices for Python Development"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Code Style"}),": Follow PEP 8 guidelines"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Documentation"}),": Use docstrings for all public methods"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Type Hints"}),": Use type hints for better code clarity"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Error Handling"}),": Implement proper exception handling"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Logging"}),": Use the ROS 2 logging system"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Resource Management"}),": Properly clean up resources"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"example-with-type-hints-and-error-handling",children:"Example with Type Hints and Error Handling"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from typing import Optional\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass RobustNode(Node):\n    def __init__(self):\n        super().__init__('robust_node')\n        self.publisher: Optional[rclpy.publisher.Publisher] = None\n        self.setup_publisher()\n\n    def setup_publisher(self) -> None:\n        try:\n            self.publisher = self.create_publisher(String, 'topic', 10)\n            self.get_logger().info('Publisher created successfully')\n        except Exception as e:\n            self.get_logger().error(f'Failed to create publisher: {e}')\n            raise\n\n    def safe_publish(self, message: str) -> bool:\n        if self.publisher is not None:\n            msg = String()\n            msg.data = message\n            try:\n                self.publisher.publish(msg)\n                return True\n            except Exception as e:\n                self.get_logger().error(f'Failed to publish message: {e}')\n                return False\n        else:\n            self.get_logger().warning('Publisher not initialized')\n            return False\n"})}),"\n",(0,a.jsx)(n.h2,{id:"building-and-running",children:"Building and Running"}),"\n",(0,a.jsx)(n.h3,{id:"build-the-package",children:"Build the Package"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select my_robot_package\n"})}),"\n",(0,a.jsx)(n.h3,{id:"source-the-workspace",children:"Source the Workspace"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n",(0,a.jsx)(n.h3,{id:"run-the-node",children:"Run the Node"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_package talker\n"})}),"\n",(0,a.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsx)(n.p,{children:"This section covered the fundamentals of creating and managing ROS 2 packages with Python. We explored the package structure, configuration files, and best practices for Python development in the ROS 2 ecosystem. Understanding these concepts is essential for building maintainable and robust robotic applications."})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>i});var t=s(6540);const a={},r=t.createContext(a);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);