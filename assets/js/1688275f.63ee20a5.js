"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics=globalThis.webpackChunkphysical_ai_humanoid_robotics||[]).push([[9842],{1831:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"module1/packages-python-development","title":"ROS 2 Packages and Python Development","description":"Package Structure","source":"@site/docs/module1/packages-python-development.md","sourceDirName":"module1","slug":"/module1/packages-python-development","permalink":"/Physical-AI-Humanoid-book/docs/module1/packages-python-development","draft":false,"unlisted":false,"editUrl":"https://github.com/user/physical-ai-humanoid-robotics/tree/main/docs/module1/packages-python-development.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Nodes, Topics, Services, and Actions","permalink":"/Physical-AI-Humanoid-book/docs/module1/nodes-topics-services-actions"},"next":{"title":"Gazebo Environment Setup","permalink":"/Physical-AI-Humanoid-book/docs/module2/gazebo-setup"}}');var t=r(4848),a=r(8453);const l={},i="ROS 2 Packages and Python Development",o={},c=[{value:"Package Structure",id:"package-structure",level:2},{value:"Creating a Python Package",id:"creating-a-python-package",level:2},{value:"Using colcon",id:"using-colcon",level:3},{value:"package.xml",id:"packagexml",level:3},{value:"setup.py",id:"setuppy",level:3},{value:"Python Node Development",id:"python-node-development",level:2},{value:"Basic Node Structure",id:"basic-node-structure",level:3},{value:"Parameter Management",id:"parameter-management",level:2},{value:"Testing in Python",id:"testing-in-python",level:2},{value:"Unit Tests",id:"unit-tests",level:3},{value:"Running Tests",id:"running-tests",level:3},{value:"Best Practices for Python Development",id:"best-practices-for-python-development",level:2},{value:"Example with Type Hints and Error Handling",id:"example-with-type-hints-and-error-handling",level:3},{value:"Building and Running",id:"building-and-running",level:2},{value:"Build the Package",id:"build-the-package",level:3},{value:"Source the Workspace",id:"source-the-workspace",level:3},{value:"Run the Node",id:"run-the-node",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ros-2-packages-and-python-development",children:"ROS 2 Packages and Python Development"})}),"\n",(0,t.jsx)(n.h2,{id:"package-structure",children:"Package Structure"}),"\n",(0,t.jsx)(n.p,{children:"A ROS 2 package is a reusable, self-contained unit of software. The basic structure of a ROS 2 package is:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"my_robot_package/\r\n\u251c\u2500\u2500 CMakeLists.txt          # Build configuration for C++\r\n\u251c\u2500\u2500 package.xml             # Package metadata\r\n\u251c\u2500\u2500 setup.py                # Python package setup\r\n\u251c\u2500\u2500 setup.cfg               # Installation configuration\r\n\u251c\u2500\u2500 my_robot_package/       # Python module\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 publisher_member_function.py\r\n\u2502   \u2514\u2500\u2500 subscriber_member_function.py\r\n\u2514\u2500\u2500 test/                   # Test files\r\n    \u2514\u2500\u2500 test_copyright.py\r\n    \u2514\u2500\u2500 test_flake8.py\r\n    \u2514\u2500\u2500 test_pep257.py\n"})}),"\n",(0,t.jsx)(n.h2,{id:"creating-a-python-package",children:"Creating a Python Package"}),"\n",(0,t.jsx)(n.h3,{id:"using-colcon",children:"Using colcon"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Create workspace\r\nmkdir -p ~/ros2_ws/src\r\ncd ~/ros2_ws/src\r\n\r\n# Create package\r\nros2 pkg create --build-type ament_python my_robot_package\n"})}),"\n",(0,t.jsx)(n.h3,{id:"packagexml",children:"package.xml"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"package.xml"})," file contains metadata about the package:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\r\n<package format="3">\r\n  <name>my_robot_package</name>\r\n  <version>0.0.0</version>\r\n  <description>Example ROS 2 package in Python</description>\r\n  <maintainer email="user@example.com">User Name</maintainer>\r\n  <license>Apache License 2.0</license>\r\n\r\n  <depend>rclpy</depend>\r\n  <depend>std_msgs</depend>\r\n\r\n  <test_depend>ament_copyright</test_depend>\r\n  <test_depend>ament_flake8</test_depend>\r\n  <test_depend>ament_pep257</test_depend>\r\n  <test_depend>python3-pytest</test_depend>\r\n\r\n  <export>\r\n    <build_type>ament_python</build_type>\r\n  </export>\r\n</package>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"setuppy",children:"setup.py"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"setup.py"})," file defines how the Python package should be built and installed:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\r\n\r\npackage_name = 'my_robot_package'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=[package_name],\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='Your Name',\r\n    maintainer_email='your.email@example.com',\r\n    description='Example ROS 2 package in Python',\r\n    license='Apache License 2.0',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'talker = my_robot_package.publisher_member_function:main',\r\n            'listener = my_robot_package.subscriber_member_function:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"python-node-development",children:"Python Node Development"}),"\n",(0,t.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n\r\n\"\"\"\r\nExample ROS 2 Python node\r\n\"\"\"\r\n\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\n\r\nclass MinimalPublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = f'Hello World: {self.i}'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n        self.i += 1\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_publisher = MinimalPublisher()\r\n\r\n    rclpy.spin(minimal_publisher)\r\n\r\n    # Destroy the node explicitly\r\n    minimal_publisher.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"parameter-management",children:"Parameter Management"}),"\n",(0,t.jsx)(n.p,{children:"ROS 2 provides a parameter system for configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom rcl_interfaces.msg import ParameterType\r\n\r\n\r\nclass ParameterNode(Node):\r\n    def __init__(self):\r\n        super().__init__('parameter_node')\r\n\r\n        # Declare parameters with default values\r\n        self.declare_parameter('frequency', 1.0)\r\n        self.declare_parameter('robot_name', 'default_robot')\r\n        self.declare_parameter('max_velocity', 1.0)\r\n\r\n        # Get parameter values\r\n        self.frequency = self.get_parameter('frequency').value\r\n        self.robot_name = self.get_parameter('robot_name').value\r\n        self.max_velocity = self.get_parameter('max_velocity').value\r\n\r\n        self.get_logger().info(\r\n            f'Parameters - Frequency: {self.frequency}, '\r\n            f'Robot: {self.robot_name}, Max Vel: {self.max_velocity}'\r\n        )\n"})}),"\n",(0,t.jsx)(n.h2,{id:"testing-in-python",children:"Testing in Python"}),"\n",(0,t.jsx)(n.h3,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import unittest\r\nimport rclpy\r\nfrom rclpy.executors import SingleThreadedExecutor\r\nfrom my_robot_package.my_node import MyNode\r\n\r\n\r\nclass TestMyNode(unittest.TestCase):\r\n    @classmethod\r\n    def setUpClass(cls):\r\n        rclpy.init()\r\n\r\n    @classmethod\r\n    def tearDownClass(cls):\r\n        rclpy.shutdown()\r\n\r\n    def setUp(self):\r\n        self.node = MyNode()\r\n        self.executor = SingleThreadedExecutor()\r\n        self.executor.add_node(self.node)\r\n\r\n    def tearDown(self):\r\n        self.node.destroy_node()\r\n\r\n    def test_node_creation(self):\r\n        self.assertIsNotNone(self.node)\r\n        self.assertEqual(self.node.get_name(), 'my_node')\r\n\r\n    def test_parameter_declaration(self):\r\n        self.assertTrue(self.node.has_parameter('frequency'))\n"})}),"\n",(0,t.jsx)(n.h3,{id:"running-tests",children:"Running Tests"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run all tests\r\ncolcon test\r\n\r\n# Run specific tests\r\ncolcon test --packages-select my_robot_package\r\n\r\n# View test results\r\ncolcon test-result --all\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices-for-python-development",children:"Best Practices for Python Development"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Code Style"}),": Follow PEP 8 guidelines"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Documentation"}),": Use docstrings for all public methods"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type Hints"}),": Use type hints for better code clarity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Error Handling"}),": Implement proper exception handling"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Logging"}),": Use the ROS 2 logging system"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Resource Management"}),": Properly clean up resources"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"example-with-type-hints-and-error-handling",children:"Example with Type Hints and Error Handling"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from typing import Optional\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\n\r\nclass RobustNode(Node):\r\n    def __init__(self):\r\n        super().__init__('robust_node')\r\n        self.publisher: Optional[rclpy.publisher.Publisher] = None\r\n        self.setup_publisher()\r\n\r\n    def setup_publisher(self) -> None:\r\n        try:\r\n            self.publisher = self.create_publisher(String, 'topic', 10)\r\n            self.get_logger().info('Publisher created successfully')\r\n        except Exception as e:\r\n            self.get_logger().error(f'Failed to create publisher: {e}')\r\n            raise\r\n\r\n    def safe_publish(self, message: str) -> bool:\r\n        if self.publisher is not None:\r\n            msg = String()\r\n            msg.data = message\r\n            try:\r\n                self.publisher.publish(msg)\r\n                return True\r\n            except Exception as e:\r\n                self.get_logger().error(f'Failed to publish message: {e}')\r\n                return False\r\n        else:\r\n            self.get_logger().warning('Publisher not initialized')\r\n            return False\n"})}),"\n",(0,t.jsx)(n.h2,{id:"building-and-running",children:"Building and Running"}),"\n",(0,t.jsx)(n.h3,{id:"build-the-package",children:"Build the Package"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select my_robot_package\n"})}),"\n",(0,t.jsx)(n.h3,{id:"source-the-workspace",children:"Source the Workspace"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n",(0,t.jsx)(n.h3,{id:"run-the-node",children:"Run the Node"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ros2 run my_robot_package talker\n"})}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"This section covered the fundamentals of creating and managing ROS 2 packages with Python. We explored the package structure, configuration files, and best practices for Python development in the ROS 2 ecosystem. Understanding these concepts is essential for building maintainable and robust robotic applications."})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var s=r(6540);const t={},a=s.createContext(t);function l(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);